!function(a){a(window.jQuery,window,document)}(function($,window,document){const rootURL="https://wsi01.sctslp.gob.mx/wcf/Dashboard.svc/",TramitesDia="ConsultarTramitesDia",TramitesDiaUpdate="ConsultarTramitesDiaUpdate",TramitesHorario="ConsultarTramitesHorario",TramitesDiaLast30="ConsultarTramitesLast30",TramitesHorarioxDia="ConsultarTramitesHorarioxDia",TramitesxMeses="ObtenerTramitesxMeses",tokenSession=sessionStorage.getItem("token"),fechaNow=new Date,yearN=fechaNow.getFullYear(),monthN=fechaNow.getMonth(),dayN=fechaNow.getDate();var spl,slp2,time,datos=[],AllData=[],DataGraficaG4=[],TotalRegistros=0,totRegTD=0,totRegTH=0,totRegTD30=0,l=0,m=0,x=0,j=0,v=0;const fechaPicker=$("#myDatepicker2").datetimepicker({format:"DD/MM/YYYY",defaultDate:new Date});let fechaRange=$("#dateRangePicker").daterangepicker({maxDate:monthN+1+"/"+dayN+"/"+yearN,autoUpdateInput:!1,locale:{cancelLabel:"Limpiar"}});async function postG1(){var resultado;const fechaRange=$("#dateRangePicker input").val();if(""===fechaRange){try{resultado=await $.ajax({type:"POST",url:rootURL+TramitesDia,data:JSON.stringify({token:tokenSession}),contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}$.when(resultado).then(function(data){datos=JSON.parse(data.d),totRegTD=datos.iRegistros,TotalRegistros=totRegTD,$(".count").html(totRegTD);for(var i=0;i<totRegTD;i++){var item,FechaTramite=datos.aoData[i].FechaTramite;slp=FechaTramite.split("-"),slp2=slp[2].split("T");var anio=slp[0],mes=slp[1],dia=slp2[0],dateItem,numDia;switch(new Date(anio,mes-1,dia).getDay()){case 1:l++;break;case 2:m++;break;case 3:x++;break;case 4:j++;break;case 5:v++}}Highcharts.chart("tramitesDia",{chart:{type:"column"},title:{text:"Trámites por día"},xAxis:{categories:["Lunes","Martes","Miercoles","Jueves","Viernes"]},yAxis:{title:{text:"Número de trámites"},tickInterval:2,gridLineWidth:1},tooltip:{crosshairs:!0},exporting:{enabled:!1},plotOptions:{line:{dataLabels:{enabled:!0}}},series:[{name:"No. de trámites",data:[l,m,x,j,v]}]}),l=0,m=0,x=0,j=0,v=0})}else{var dateRange=fechaRange.split(" - "),dateInicial=dateRange[0],dateFinal=dateRange[1],dataJson=JSON.stringify({token:tokenSession,fechaInit:dateInicial,fechaEnd:dateFinal});try{resultado=await $.ajax({type:"POST",url:rootURL+TramitesDia,data:dataJson,contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}$.when(resultado).then(function(data){datos=JSON.parse(data.d),totRegTD=datos.iRegistros,$(".count").html(totRegTD);for(var i=0;i<totRegTD;i++){var item,FechaTramite=datos.aoData[i].FechaTramite;slp=FechaTramite.split("-"),slp2=slp[2].split("T");var anio=slp[0],mes=slp[1],dia=slp2[0],dateItem,numDia;switch(new Date(anio,mes-1,dia).getDay()){case 1:l++;break;case 2:m++;break;case 3:x++;break;case 4:j++;break;case 5:v++}}Highcharts.chart("tramitesDia",{chart:{type:"column"},title:{text:"Trámites por día"},xAxis:{categories:["Lunes","Martes","Miercoles","Jueves","Viernes"]},yAxis:{title:{text:"Número de trámites"},tickInterval:2,gridLineWidth:1},tooltip:{crosshairs:!0},exporting:{enabled:!1},plotOptions:{line:{dataLabels:{enabled:!0}}},series:[{name:"No. de trámites",data:[l,m,x,j,v]}]}),l=0,m=0,x=0,j=0,v=0})}}async function postG2(){var resultado;const fechaRange=$("#dateRangePicker input").val();if(""===fechaRange){try{resultado=await $.ajax({type:"POST",url:rootURL+TramitesDiaLast30,data:JSON.stringify({token:tokenSession}),contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}$.when(resultado).then(function(data){datos=JSON.parse(data.d),totRegTD30=datos.iRegistros;for(var i=0;i<totRegTD30;i++){var item=datos.aoData[i],FechaTramite=item.fechaStr,valor=item.numRegistrosFecha;slp=FechaTramite.split("T");var anio=(slp2=slp[0].split("-"))[0],mes=slp2[1],dia=slp2[2];AllData.push([Date.UTC(anio,mes-1,dia),valor])}Highcharts.chart("tramitesDiaUlt30",{chart:{type:"line"},title:{text:"Trámites al mes"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%e. %b",year:"%b"},max:fechaNow,tickInterval:432e6},yAxis:{title:{text:"Número de trámites"},tickInterval:2,gridLineWidth:1},tooltip:{crosshairs:!0},exporting:{enabled:!1},plotOptions:{line:{dataLabels:{enabled:!0}}},series:[{name:"No. de trámites",data:AllData}]}),AllData=[]})}else{var dateRange=fechaRange.split(" - "),dateInicial=dateRange[0],dateFinal=dateRange[1],fechaF=dateFinal.split("/"),fechaMax=new Date(fechaF[2],fechaF[1]-1,fechaF[0]),dateFinalArr=dateFinal.split("/"),dataJson=JSON.stringify({token:tokenSession,fechaInit:dateInicial,fechaEnd:dateFinal});try{resultado=await $.ajax({type:"POST",url:rootURL+TramitesDiaLast30,data:dataJson,contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}$.when(resultado).then(function(data){datos=JSON.parse(data.d),totRegTD30=datos.iRegistros;for(var i=0;i<totRegTD30;i++){var item=datos.aoData[i],FechaTramite=item.fechaStr,valor=item.numRegistrosFecha;slp=FechaTramite.split("T");var anio=(slp2=slp[0].split("-"))[0],mes=slp2[1],dia=slp2[2],dateItem=new Date(anio,mes-1,dia);AllData.push([Date.UTC(anio,mes-1,dia),valor])}Highcharts.chart("tramitesDiaUlt30",{chart:{type:"line"},title:{text:"Trámites al mes"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%e. %b",year:"%b"},max:fechaMax,tickInterval:432e6},yAxis:{title:{text:"Número de trámites"},tickInterval:2,gridLineWidth:1},tooltip:{crosshairs:!0},exporting:{enabled:!1},plotOptions:{line:{dataLabels:{enabled:!0}}},series:[{name:"No. de trámites",data:AllData}]}),AllData=[]})}}async function postG3(){var resultado;const fechaPicker=$("#datePicker").val();if(""===fechaPicker){try{resultado=await $.ajax({type:"POST",url:rootURL+TramitesHorario,data:JSON.stringify({token:tokenSession}),contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}$.when(resultado).then(function(data){var h9=0,h10=0,h11=0,h12=0,h13=0,h14=0,h15=0,meses=[],dias=[];datos=JSON.parse(data.d),totRegTH=datos.iRegistros;for(var i=0;i<totRegTH;i++){var item,FechaTramite=datos.aoData[i].FechaTramite;slp=FechaTramite.split("-");var horaio=(slp2=slp[2].split("T"))[1].split(":"),hora=parseInt(horaio[0]),minuto=horaio[1];hora<9?h9++:hora<10?h10++:hora<11?h11++:hora<12?h12++:hora<13?h13++:hora<14?h14++:hora<15&&h15++}Highcharts.chart("traitesHorario",{chart:{type:"column"},title:{text:"Trámites por horario"},xAxis:{categories:["8am-9am","9am-10am","10am-11am","11am-12pm","12pm-13pm","13pm-14pm","14pm-15pm"]},yAxis:{title:{text:"Número de trámites"},tickInterval:2,gridLineWidth:1},tooltip:{crosshairs:!0},exporting:{enabled:!1},series:[{name:"No. de trámites",data:[h9,h10,h11,h12,h13,h14,h15]}]}),h9=0,h10=0,h11=0,h12=0,h13=0,h14=0,h15=0})}else{var val,dateArr=fechaPicker.split("/"),diaR=dateArr[0],mesR=dateArr[1],anioR=dateArr[2];try{resultado=await $.ajax({type:"POST",url:rootURL+TramitesHorarioxDia,data:JSON.stringify({token:tokenSession,dia:diaR,mes:mesR,anio:anioR}),contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}$.when(resultado).then(function(data){var h9=0,h10=0,h11=0,h12=0,h13=0,h14=0,h15=0,meses=[],dias=[];datos=JSON.parse(data.d),totRegTH=datos.iRegistros;for(var i=0;i<totRegTH;i++){var item,FechaTramite=datos.aoData[i].FechaTramite;slp=FechaTramite.split("-");var horaio=(slp2=slp[2].split("T"))[1].split(":"),hora=parseInt(horaio[0]),minuto=horaio[1];hora<9?h9++:hora<10?h10++:hora<11?h11++:hora<12?h12++:hora<13?h13++:hora<14?h14++:hora<15&&h15++}Highcharts.chart("traitesHorario",{chart:{type:"column"},title:{text:"Trámites por horario"},xAxis:{categories:["8am-9am","9am-10am","10am-11am","11am-12pm","12pm-13pm","13pm-14pm","14pm-15pm"]},yAxis:{title:{text:"Número de trámites"},tickInterval:2,gridLineWidth:1},tooltip:{crosshairs:!0},exporting:{enabled:!1},series:[{name:"No. de trámites",data:[h9,h10,h11,h12,h13,h14,h15]}]});var h9=0,h10=0,h11=0,h12=0,h13=0,h14=0,h15=0})}}async function postG4(){var resultado;const fechaRange=$("#dateRangePicker input").val();if(""===fechaRange){try{resultado=await $.ajax({type:"POST",url:rootURL+TramitesxMeses,data:JSON.stringify({token:tokenSession}),contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}$.when(resultado).then(function(data){var info;datos=JSON.parse(data.d),totRegTD30=datos.iRegistros,datos.aoData.forEach(element=>{var anioFecha=element.fechaYear,mesFecha=element.fechaMonth,fechaRegistro=Date.UTC(anioFecha,mesFecha-1,1),numRegistros=element.numRegistrosFecha;DataGraficaG4.push([fechaRegistro,numRegistros])}),DataGraficaG4.sort(),Highcharts.chart("tramitesxMes",{chart:{type:"line"},title:{text:"Trámites por mes"},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b %Y"},max:fechaNow},yAxis:{title:{text:"Número de trámites"},tickInterval:2,gridLineWidth:1},tooltip:{crosshairs:!0},exporting:{enabled:!1},plotOptions:{line:{dataLabels:{enabled:!0}}},series:[{name:"No. de trámites",data:DataGraficaG4}]}),DataGraficaG4=[]})}}$(window).on("load",function(){postG1(),postG2(),postG3(),postG4()}),setInterval(async function(){try{var resultado=await $.ajax({type:"POST",url:rootURL+TramitesDiaUpdate,data:JSON.stringify({TotalRegistros:TotalRegistros,token:tokenSession}),contentType:"application/json;charset=utf-8",dataType:"json"})}catch(error){console.log(error)}$.when(resultado).then(function(data){var item;!0===(datos=JSON.parse(data.d)).aoData&&(postG1(),postG2(),postG3(),postG4())})},3e3),$("#datePicker").on("focusout",function(){postG3()}),$("#dateRangePicker").on("apply.daterangepicker",function(ev,picker){$("#dateRangePicker input").val(picker.startDate.format("DD/MM/YYYY")+" - "+picker.endDate.format("DD/MM/YYYY")),postG1(),postG2()})});