!function(a){a(window.jQuery,window,document)}(function($,window,document){var datos,resultado,resultadoP,arrayP=[],rootURL,urlDasboard;function getConfig(){$.getJSON("../js/config_Dashboard.json",function(data){var ambiente=data.ambiente_Server;rootURL=data[ambiente],sessionStorage.setItem("rootURL",rootURL);var ambienteD=data.ambiente_Dashboard;urlDasboard=data[ambienteD],sessionStorage.setItem("urlDashboard",urlDasboard)})}const autenticacion="Autenticacion",permisos="ObtenerPermisos",consultarPermisos="ObtenerPermisosG";var validateFront=function(){!0===$("#formLogin").parsley().isValid()?($(".bs-callout-info").removeClass("hidden"),$(".bs-callout-warning").addClass("hidden")):($(".bs-callout-info").addClass("hidden"),$(".bs-callout-warning").removeClass("hidden"))};async function Login(){var user=$("#user").val(),pass=$("#pass").val();pass=md5(pass).substring(0,20);try{resultado=await $.ajax({type:"POST",async:!1,url:rootURL+autenticacion,data:JSON.stringify({usuario:user,password:pass}),contentType:"application/json;charset=utf-8",dataType:"json"})}catch(error){console.log(error)}$.when(resultado).then(function(data){var item=(datos=JSON.parse(data.d)).aoData;if("-0|"!=item){var tokenS=item.split("|");sessionStorage.setItem("token",tokenS[0]),sessionStorage.setItem("NombreU",tokenS[1]),window.location.replace(urlDasboard+"home.html")}else PNotify.notice({title:"Acceso incorrecto",text:"Verifique que las credenciales son correctas",styling:"bootstrap4",delay:5e3})});try{resultadoP=await $.ajax({type:"POST",async:!1,url:rootURL+permisos,data:JSON.stringify({usuario:user,password:pass}),contentType:"application/json;charset=utf-8",dataType:"json"})}catch(error){console.log(error)}$.when(resultadoP).then(function(data){const cPrefix="permit_";datos=JSON.parse(data.d);const arrayPer=[],arrayRol=[],arrarRolDes=[],itemS=datos.aoData;null!=itemS&&(itemS.forEach(element=>{arrayPer.push(element.permiso),arrayRol.push(element.rol),arrarRolDes.push(element.des_rol)}),arrayPer.forEach(element=>{$.cookie(cPrefix+element,1)}),sessionStorage.setItem("permisos",arrayPer),sessionStorage.setItem("roles",arrayRol))});try{var result=await $.ajax({type:"POST",async:!1,url:rootURL+consultarPermisos,data:JSON.stringify({token:sessionStorage.getItem("token")}),contentType:"application/json;charset=utf-8",dataType:"json"})}catch(error){console.log(error)}$.when(result).then(function(data){var datos,itemData;JSON.parse(data.d).aoData.forEach(element=>{arrayP.push(element.clavePer)}),sessionStorage.setItem("perG",arrayP)})}$("#btnLogin").on("click",async function(){$("#formLogin").parsley().validate(),validateFront(),!0===$("#formLogin").parsley().isValid()&&Login()}),$(window).on("load",function(){getConfig()})});