(function(a){a(window.jQuery,window,document)}(function($,window,document){const rootURL="https://wsi01.sctslp.gob.mx/wcf/Dashboard.svc/";const consultarReporte1="ObtenerReporte1";const consultarReporte2="ObtenerReporte2";const tokenSession=sessionStorage.getItem('token');const fechaNow=new Date();const yearN=fechaNow.getFullYear();const monthN=fechaNow.getMonth();const dayN=fechaNow.getDate();var registrosRep=[];var registrosRep2=[];var table1;var table2;var flagTbl1,flagTbl2=!1;function paddingDates(date){const pad="00";const str=""+date;return pad.substring(0,pad.length-str.length)+str}
    $("#dateRangePicker1").daterangepicker({"maxDate":(monthN+1)+"/"+dayN+"/"+yearN,autoUpdateInput:!1,locale:{cancelLabel:'Clear'}});$("#dateRangePicker2").daterangepicker({"maxDate":(monthN+1)+"/"+dayN+"/"+yearN,autoUpdateInput:!1,locale:{cancelLabel:'Clear'}});async function cargaTablaReporte1(){const fechaRep1=$("#dateRangePicker1").val();if(fechaRep1!==""){var dateRange=fechaRep1.split(" - ");var dateInicial=dateRange[0];var dateFinal=dateRange[1];var dateFinalArr=dateFinal.split('/');var dataJson=JSON.stringify({token:tokenSession,fechaInit:dateInicial,fechaEnd:dateFinal});var resultado;try{resultado=await $.ajax({type:"POST",url:rootURL+consultarReporte1,data:dataJson,contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}
        $.when(resultado).then(function(data){$("#tablaReportes1 thead").show();datos=JSON.parse(data.d);totRegRep=datos.iRegistros;TotalRegistros=totRegRep;registrosRep=datos.aoData;var cont=0;registrosRep.forEach(element=>{$("#TblRep1Body").append("<tr id='tblReporteFila"+cont+"'></tr>");const fila=$("#tblReporteFila"+cont);fila.append("<td>"+element.NumGafete+"</td>");var arrayFechaT=element.FechaTramite.split('T');fila.append("<td>"+arrayFechaT[0]+"</td>");fila.append("<td>"+element.MotivoIncompleto+"</td>");fila.append("<td>"+element.Ubicacion+"</td>");fila.append("<td>"+element.NombreCompleto+"</td>");var arrayFechaN=element.FechaNacimiento.split('T');fila.append("<td>"+arrayFechaN[0]+"</td>");fila.append("<td>"+element.Modalidad+"</td>");fila.append("<td>"+element.Descripcion+"</td>");fila.append("<td>"+element.AniosGafete+"</td>");var arrayFechaTG=element.FechaExpedicionGafete.split('T');fila.append("<td>"+arrayFechaTG[0]+"</td>");fila.append("<td>"+element.AniosLicencia+"</td>");fila.append("<td>"+element.TipoLicencia+"</td>");fila.append("<td>"+element.Nombre+"</td>");fila.append("<td>"+element.IdLinea+"</td>");fila.append("<td>"+element.Clave+"</td>");fila.append("<td>"+element.LineaNombre+"</td>");fila.append("<td>"+element.Concesiones+"</td>");cont++});table1=$("#tablaReportes1").DataTable({dom:'Bfrtlip',buttons:['excel']});flagTbl1=!0;table1.column(2).visible(!1);table1.column(3).visible(!1);table1.column(5).visible(!1);table1.column(8).visible(!1);table1.column(9).visible(!1);table1.column(10).visible(!1);table1.column(11).visible(!1);table1.column(12).visible(!1);table1.column(13).visible(!1);table1.column(14).visible(!1);table1.column(15).visible(!1);table1.column(16).visible(!1)})}}
    async function cargaTablaReporte2(){const fechaRep2=$("#dateRangePicker2").val();if(fechaRep2!==""){var dateRange=fechaRep2.split(" - ");var dateInicial=dateRange[0];var dateFinal=dateRange[1];var dateFinalArr=dateFinal.split('/');var dataJson=JSON.stringify({token:tokenSession,fechaInit:dateInicial,fechaEnd:dateFinal});var resultado;try{resultado=await $.ajax({type:"POST",url:rootURL+consultarReporte2,data:dataJson,contentType:"application/json; charset=utf-8"})}catch(error){console.log(error)}
        $.when(resultado).then(function(data){$("#tablaReportes2 thead").show();resultado=data;datos=JSON.parse(data.d);totRegRep=datos.iRegistros;TotalRegistros=totRegRep;registrosRep2=datos.aoData;var cont=0;registrosRep2.forEach(element=>{var tt=parseInt(element.IdTipoTramite);$("#TblRep2Body").append("<tr id='tblReporteFila"+cont+"'></tr>");const fila=$("#tblReporteFila"+cont);fila.append("<td>"+element.NoGafete+"</td>");fila.append("<td>"+element.IdTramiteExpediente+"</td>");var fechaTramite=element.FechaTramite.split("-");fila.append("<td>"+paddingDates(fechaTramite[2])+"/"+paddingDates(fechaTramite[1])+"/"+fechaTramite[0]+"</td>");fila.append("<td>"+element.TramiteRealizado+"</td>");var cadena;element.AniosTipos==null?cadena="":cadena=element.AniosTipos.split("|")
            if(tt<6){const fechat=new Date(element.FechaTramite);if(cadena!==""){if(tt===4||tt===5){var tipo=cadena[0].split(",");var anio="";var fvl=""}else{var anios=cadena[0].split(",");var anio=parseInt(anios[1]);var tipo=cadena[1].split(",");var fvl=paddingDates(fechat.getDate())+"/"+paddingDates(fechat.getMonth()+1)+"/"+(fechat.getFullYear()+anio)}}else{var anio="";var tipo=["",""];var fvl=""}
                fila.append("<td>"+anio+"</td>");fila.append("<td>"+tipo[1]+"</td>");fila.append("<td>"+fvl+"</td>");fila.append("<td></td>");fila.append("<td></td>");fila.append("<td></td>")}else{if(cadena!==""){if(tt===9||tt===10||tt===11){var anio="";var fechaV=cadena[0].split(",");var dateVG=[];dateVG[0]=fechaV[1];dateVG[0]==="dd/MM/yyyy"?dateVG[0]="":dateVG[0];var anioV=fechaV[1].split("/");var fechaX=new Date(anioV[2],anioV[1],anioV[0]);var fvl=""}else{var anios=cadena[0].split(",");var anio=parseInt(anios[1]);var Vgafete=[""];if(cadena[1]!==undefined)var Vgafete=cadena[1].split(",");var dateVG=Vgafete[1].split(" ");var anioV=dateVG[0].split("/");var fechaX=new Date(anioV[2],anioV[1],anioV[0]);var fvl=anioV[0]+"/"+(anioV[1])+"/"+(parseInt(anioV[2])-anio)}}else{var anio="";var dateVG=[""];var fvl=""}
                fila.append("<td></td>");fila.append("<td></td>");fila.append("<td></td>");fila.append("<td>"+anio+"</td>");fila.append("<td>"+dateVG[0]+"</td>");fila.append("<td>"+fvl+"</td>")}
            fila.append("<td>"+element.Nombres+"</td>");fila.append("<td>"+element.ApellidoPaterno+"</td>");fila.append("<td>"+element.ApellidoMaterno+"</td>");var fToxi=element.FechaToxicologico;var valor;if(fToxi[0]===undefined){var stringv=""}else{valor=fToxi[0].FechaExpedicion;if(valor==null){var stringv=""}else{var arrValor=valor.split("T");if(arrValor[0]==="1999-10-03"){var stringv=""}else{valor=arrValor[0].split("-");var stringv=valor[2]+"/"+valor[1]+"/"+valor[0]}}}
            fila.append("<td>"+stringv+"</td>");fila.append("<td>"+element.MunicipioAdscripcion+"</td>");var valFN=element.FechaNacimiento==="//"?"":element.FechaNacimiento;fila.append("<td>"+valFN+"</td>");fila.append("<td>"+element.Clave+"</td>");fila.append("<td>"+element.Linea+"</td>");fila.append("<td>"+element.Modalidad+"</td>");fila.append("<td>"+element.Concesiones+"</td>");fila.append("<td>"+element.Usuario+"</td>");cont++});table2=$("#tablaReportes2").DataTable({dom:'Bfrtlip',buttons:['excel']});flagTbl2=!0;table2.column(14).visible(!1);table2.column(15).visible(!1);table2.column(16).visible(!1);table2.column(17).visible(!1);table2.column(18).visible(!1);table2.column(20).visible(!1)});return resultado}}
    $('input[name="dateRangePicker1"]').on('apply.daterangepicker',function(ev,picker){$(this).val(picker.startDate.format('DD/MM/YYYY')+' - '+picker.endDate.format('DD/MM/YYYY'));if($.fn.dataTable.isDataTable('#tablaReportes1')){table1.destroy();$("#TblRep1Body").empty()}
        cargaTablaReporte1()});$('input[name="dateRangePicker2"]').on('apply.daterangepicker',function(ev,picker){$(this).val(picker.startDate.format('DD/MM/YYYY')+' - '+picker.endDate.format('DD/MM/YYYY'));if($.fn.dataTable.isDataTable('#tablaReportes2')){table2.destroy();$("#TblRep2Body").empty()}
        cargaTablaReporte2()})}))